{"componentChunkName":"component---src-templates-documentation-template-js","path":"/documentation/test/","result":{"data":{"markdownRemark":{"html":"<h1 id=\"testplan\" style=\"position:relative;\"><a href=\"#testplan\" aria-label=\"testplan permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Testplan</h1>\n<p>Formålet med testen er å verifisere uthenting av skattemelding for en skattepliktig og bruk av valideringstjenesten hos Skatteetaten.\nI tillegg legger vi opp til muligheten til å instansiere opp en instans for skattemelding på den nye Altinn 3 plattformen.\nDet skal også være tilgjengelig funksjonalitet for å laste opp filer med skattemelding og næringsopplysninger på instansen i Altinn.</p>\n<h1 id=\"innhold-i-testen\" style=\"position:relative;\"><a href=\"#innhold-i-testen\" aria-label=\"innhold i testen permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Innhold i testen</h1>\n<p>Konkret må sluttbrukersystemet gjøre følgende:</p>\n<ol>\n<li>Få etablert et kundeforhold hos Digitaliseringsdirektoratet (DigDir) og ta i bruk ID-porten.</li>\n<li>Logge inn hos ID-porten for å få en sesjon (og token).</li>\n<li>\n<p>Utvikle en applikasjon/klient som:</p>\n<ul>\n<li>Sende en request til Skatteetatens tjeneste for å hente ut skattemeldingen for en skattepliktig.</li>\n<li>Sende en request til Skatteetatens tjeneste for å validere skattemelding med næringsinformasjon for en skattepliktig</li>\n<li>Motta og tolke resultatet fra valideringstjenesten.</li>\n<li>Når det ikke er feil i retur fra valideringstjenesten kan man gå til punkt E</li>\n<li>Kalle Altinn sin nye plattform for å instansiere opp App'en for innsending av skattemelding for næringsdrivende.</li>\n<li>Kalle Altinn for å laste opp skattemelding og næringsopplysninger på den instansierte App'en fra pkt e.</li>\n</ul>\n</li>\n</ol>\n<p>Skatteetaten har tilgjengeliggjort en test-applikasjon som viser hvordan trinnene beskrevet over kan utføres:\n<a href=\"/skattemeldingen/5915fb336cfa379195e11ce501a29c6f/skattemelding-eksternt-api-test.zip\">skattemelding-eksternt-api-test.zip</a></p>\n<h2 id=\"ta-i-bruk-id-porten\" style=\"position:relative;\"><a href=\"#ta-i-bruk-id-porten\" aria-label=\"ta i bruk id porten permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Ta i bruk ID-porten</h2>\n<p>Det første som en konsument av skattemeldings-API må gjøre er å etablere et kundeforhold hos Digitaliseringsdirektoratet (DigDir). Detaljer rundt hvordan ta i bruk ID-porten er beskrevet her: <a href=\"https://samarbeid.difi.no/felleslosninger/id-porten/ta-i-bruk-id-porten\">https://samarbeid.difi.no/felleslosninger/id-porten/ta-i-bruk-id-porten</a>. Denne prosessen er delvis manuell så det er lurt å starte prosessen tidlig slik at dere kan komme i gang med testingen. Ved bestilling må dere oppgi at dere ønsker tilgang til skattemeldings-API fra skatteetaten.</p>\n<p>Et kundeforhold hos DigDir gir tilgang til deres selvbetjeningsløsning som igjen gir tilgang til administrasjon av Kundens bruk av ID-porten. I selvbetjeningsløsning kan kunden genere et såkalt client_id og definere et callback-url:</p>\n<ul>\n<li>client_id: er unik automatisk generert identifikator for tjenesten.</li>\n<li>\n<p>callback-url: Uri-en som klienten får lov å gå til etter innlogging. Etter en vellykket innlogging i ID-porten vil denne url-en bli kalt.\nDersom det skulle ta for lang tid å få opprettet et kundeforhold hos DigDir kan sluttbrukersystemene i mellomtiden benytte Skatteetatens client<em>id. For denne testen har Skatteetaten opprettet følgende client</em>id som kan benyttes av sluttbrukersystemene:</p>\n<ul>\n<li><code class=\"language-text\">client_id: 38e634d9-5682-44ae-9b60-db636efe3156</code></li>\n<li>Callback-URL til denne client_id er satt til <a href=\"http://localhost:12345/token\">http://localhost:12345/token</a> (Hvis det er konsumenter som ønsker andre callback-URL kan vi ordne det)</li>\n</ul>\n</li>\n</ul>\n<p><strong>Nyttige lenker:</strong></p>\n<ul>\n<li>Klienten bruker test-miljøet i DigDir, \"verifikasjon 2\": <a href=\"https://samarbeid.difi.no/node/232\">https://samarbeid.difi.no/node/232</a></li>\n<li>OIDC-integrasjonen er beskrevet her: <a href=\"https://difi.github.io/felleslosninger/oidc_index.html\">https://difi.github.io/felleslosninger/oidc_index.html</a></li>\n<li>Hvordan lage en klient i selvregistreringen: <a href=\"https://minside-samarbeid.difi.no/organization-home/services/service-admin#/\">https://minside-samarbeid.difi.no/organization-home/services/service-admin#/</a></li>\n</ul>\n<h2 id=\"logge-inn-hos-id-porten\" style=\"position:relative;\"><a href=\"#logge-inn-hos-id-porten\" aria-label=\"logge inn hos id porten permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Logge inn hos ID-porten</h2>\n<p>Klienten må foreta følgende REST kall mot ID-porten:</p>\n<ul>\n<li>Starte system browser og gjøre autorisasjonskall mot ID-porten. Les mer om det her: <a href=\"https://difi.github.io/felleslosninger/oidc_protocol_authorize.html\">https://difi.github.io/felleslosninger/oidc_protocol_authorize.html</a></li>\n<li>Brukeren blir da sendt til ID-porten for innlogging. Dere kan benytte eksisterende test-brukere som dere benytter til test mot skattemeldingen i dag.</li>\n<li>Sette opp en webserver som venter på callback fra browseren. Etter vellykket pålogging i ID-porten sendes brukes til denne webserveren. Denne webserveren må være satt til å lytte på callback-URL <a href=\"http://localhost:12345/token\">http://localhost:12345/token</a> (ref. forrige kapittel).</li>\n<li>Gjøre et tokenforespørsel. Les mer om det her: <a href=\"https://difi.github.io/felleslosninger/oidc_protocol_token.html\">https://difi.github.io/felleslosninger/oidc_protocol_token.html</a></li>\n</ul>\n<p>Vi benytter følgende testmiljø hos ID-porten:</p>\n<ul>\n<li>/authorize endpoint: <a href=\"https://oidc-ver2.difi.no/idporten-oidc-provider/authorize\">https://oidc-ver2.difi.no/idporten-oidc-provider/authorize</a></li>\n<li>/token endpoint: <a href=\"https://oidc-ver2.difi.no/idporten-oidc-provider/token\">https://oidc-ver2.difi.no/idporten-oidc-provider/token</a></li>\n</ul>\n<p>For detaljer rundt hvilken HTTP parametere som må sendes med i kallet, se filen hent.py: <a href=\"/skattemeldingen/5915fb336cfa379195e11ce501a29c6f/skattemelding-eksternt-api-test.zip\">skattemelding-eksternt-api-test.zip</a></p>\n<h2 id=\"kalle-skattemeldings-api\" style=\"position:relative;\"><a href=\"#kalle-skattemeldings-api\" aria-label=\"kalle skattemeldings api permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Kalle skattemeldings-API</h2>\n<p>Når callback-URL blir kalt må klienten plukke ut JWT-tokenet fra responsen og legge det i header-feltet Authorization og kalle skattemeldings-API. For detaljer, se filen hent.py: <a href=\"/skattemeldingen/5915fb336cfa379195e11ce501a29c6f/skattemelding-eksternt-api-test.zip\">skattemelding-eksternt-api-test.zip</a></p>\n<p>URL til skattemeldings-API i test er: <a href=\"https://mp-test.sits.no/\">https://mp-test.sits.no/</a></p>\n<p>Første testen bør være å teste at klienten når frem, dette kan gjøres ved å kalle ping tjenesten:</p>\n<ul>\n<li><code class=\"language-text\">GET https://&lt;env&gt;/api/eksterntapi/formueinntekt/skattemelding/ping</code></li>\n<li><code class=\"language-text\">Eksempel: GET https://mp-test.sits.no/api/eksterntapi/formueinntekt/skattemelding/ping</code></li>\n</ul>\n<p>For nærmere beskrivelse av skattemelding-API og Altinn3-API, se kapitelet <a href=\"/skattemeldingen/60231d0377d760121b3128485df0adfa/index.md\">API</a></p>\n<h1 id=\"se-skattemelding-i-portal\" style=\"position:relative;\"><a href=\"#se-skattemelding-i-portal\" aria-label=\"se skattemelding i portal permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Se skattemelding i portal</h1>\n<p>URL til portal: <a href=\"https://skatt-ref.sits.no/web/skattemeldingen/2020\">https://skatt-ref.sits.no/web/skattemeldingen/2020</a></p>\n<p>Bruk MinID innlogging; fnr på testbruker, password01 og Pinkode 12345.</p>\n<p>Merk at dere også kan endre/tilføye opplysninger og sende inn skattemelding. Fastsatt skattemelding (endret skattemelding) vil da også være tilgjengelig for nedlasting. Se kapittel 4.3.6.3 i implementasjonsguide.</p>\n<h1 id=\"tidsplan-henvendelser-og-tilbakemelding-på-testresultater\" style=\"position:relative;\"><a href=\"#tidsplan-henvendelser-og-tilbakemelding-p%C3%A5-testresultater\" aria-label=\"tidsplan henvendelser og tilbakemelding på testresultater permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>Tidsplan, henvendelser og tilbakemelding på testresultater</h1>\n<p>Tidsplan, henvendelser og tilbakemelding på testresultater\nTestmiljøet vil være tilgjengelig fra 10.6. Det er ikke bestemt sluttdato for gjennomføring, men vi ønsker at flest mulig får gjennomført testen så raskt det lar seg gjøre.</p>\n<p>Tekniske spørsmål knyttet til forberedelser og gjennomføring kan rettes til nyskattemelding@skatteetaten.no</p>\n<p>Etter gjennomført test ønsker vi at dere sender en testrapport på resultatet av gjennomført test. Den kan dere sende til samme adresse som over. I testrapporten beskriver dere hvordan dere har gjennomført test (om dere har brukt testklienten eller egenutviklet kode), resultatet og eventuelle kommentarer.</p>","headings":[{"value":"Testplan","depth":1},{"value":"Innhold i testen","depth":1},{"value":"Ta i bruk ID-porten","depth":2},{"value":"Logge inn hos ID-porten","depth":2},{"value":"Kalle skattemeldings-API","depth":2},{"value":"Se skattemelding i portal","depth":1},{"value":"Tidsplan, henvendelser og tilbakemelding på testresultater","depth":1}],"fields":{"slug":"/documentation/test/"},"frontmatter":{"title":"Testmiljø og -klienter"}}},"pageContext":{"slug":"/documentation/test/"}},"staticQueryHashes":["270254161"]}